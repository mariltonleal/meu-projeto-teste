// Script para o projeto de teste

document.addEventListener('DOMContentLoaded', () => {
    console.log('Documento carregado!');
    
    // Adicionar a data atual no footer
    const dataAtual = new Date();
    const anoAtual = dataAtual.getFullYear();
    const footerElement = document.querySelector('footer p');
    
    if (footerElement) {
        footerElement.innerHTML = `&copy; ${anoAtual} - Criado por Claude AI`;
    }
    
    // Mostrar uma mensagem de boas-vindas
    const boasVindas = () => {
        const hora = dataAtual.getHours();
        let saudacao;
        
        if (hora < 12) {
            saudacao = "Bom dia!";
        } else if (hora < 18) {
            saudacao = "Boa tarde!";
        } else {
            saudacao = "Boa noite!";
        }
        
        // Criar um elemento de saudação
        const headerElement = document.querySelector('header');
        const saudacaoElement = document.createElement('div');
        saudacaoElement.className = 'saudacao';
        saudacaoElement.textContent = saudacao;
        saudacaoElement.style.color = '#3388ff';
        saudacaoElement.style.fontWeight = 'bold';
        saudacaoElement.style.marginTop = '10px';
        
        if (headerElement) {
            headerElement.appendChild(saudacaoElement);
        }
    };
    
    boasVindas();
    
    // Adicionar evento de clique na lista
    const itensLista = document.querySelectorAll('ul li');
    
    itensLista.forEach((item, index) => {
        item.style.cursor = 'pointer';
        item.style.transition = 'color 0.3s';
        
        item.addEventListener('mouseover', () => {
            item.style.color = '#3388ff';
        });
        
        item.addEventListener('mouseout', () => {
            item.style.color = '';
        });
        
        item.addEventListener('click', () => {
            alert(`Você clicou em: ${item.textContent}`);
        });
    });
});
